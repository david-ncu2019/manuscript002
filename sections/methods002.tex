% \section{Methodology}

\subsection{SBAS-InSAR time series processing}
\label{subsec:sbas}

This study derived cumulative vertical displacement from an 8-year dataset of Sentinel-1 SAR images \text{(2016 - 2024)}, acquired from both ascending and descending orbits; the image properties are summarized in \Cref{tab:sentinel1_info}. First, the images from each acquisition orbit were processed separately applying the \textbf{\textit{hyp3-isce2}} plugin, part of the Hybrid Pluggable Processing Pipeline (HyP3) \citep{hyp3-isce2}. For interferogram formation, each SAR image was paired with up to four subsequent consecutive images to minimize temporal decorrelation. Next, each image pair was analyzed using the InSAR Scientific Computing Environment 2 (ISCE2) TOPS workflow, which sequentially performs burst-level coregistration of Single Look Complex (SLC) images, interferogram generation, waterbody masking and topographic phase correction with the Copernicus GLO-30 DEM, phase unwrapping via the SNAPHU algorithm, and geocoding to produce unwrapped interferograms suitable for further time-series InSAR analysis. A detailed description of the ISCE2 workflow is available in \citep{isce2_rosen, tops, nesd_tops}.

Subsequently, a time-series analysis was conducted on the unwrapped interferograms from ascending and descending orbits separately using the small baseline subset approach, provided by Miami InSAR Time-series software (MintPy) \citep{mintpy_yunjun}. The valid interferogram network was formed through a two-stage selection. The minimum spanning tree (MST) \citep{mst_perissin} first identified the most coherent interferograms to connect all SAR images, by using the inverse of the average spatial coherence of all interferograms as weight. After this, any interferograms not included in the MST were excluded if their average spatial coherence was lower than $\text{0.3}$. After network formation, the optimal values of the interferometric phase timeseries were estimated through a network inversion using the inverse of the phase variance as weight \citep{networkinverse_var}. The temporal coherence, as a product of the network inversion process, was utilized to evaluate the reliability of the estimated value at each pixel \citep{temporal_coherence}. Pixels with temporal coherence ($\gamma_\textit{temp}$) below 0.65 were then masked from further processing. Regarding atmospheric correction, the tropospheric delay components were removed based on the empirical linear relationship between InSAR phase delay and elevation \citep{height_correlation}. All interferograms from both ascending and descending orbits were referenced to a single stable point, which was located far from the subsiding area (\Cref{fig:insar_leveling_a}). Finally, the line-of-sight deformation (${d_\textit{LOS}}$) was decomposed into the east-west (${d_\textit{E-W}}$) and vertical (${d_\textit{U}}$) components, assuming the deformation in north-south direction (${d_\textit{N-S}}$) was negligible. The decomposition employed the incidence angles ($\theta$) and satellite heading angles ($\alpha$) from both ascending ($\textit{asc}$) and descending ($\textit{desc}$) images \citep{hanssen_book}:

\begin{equation}
	\begin{bmatrix}
		d_{\textit{U}} \\
		d_{\textit{E-W}}
	\end{bmatrix}
	=
	\begin{bmatrix}
		\cos(\theta^{\text{asc}}) & \sin(\theta^{\text{asc}}) \cos(\alpha^{\text{asc}}) \\
		\cos(\theta^{\text{desc}}) & \sin(\theta^{\text{desc}}) \cos(\alpha^{\text{desc}})
	\end{bmatrix}^{-1}
	\begin{bmatrix}
		d_{\textit{LOS}}^{\text{asc}} \\
		d_{\textit{LOS}}^{\text{desc}}
	\end{bmatrix}.
	\label{eq:decomposition} %<-- Correct placement and spelling
\end{equation}


Validation of the vertical displacements was performed against precise leveling survey, with benchmarks locations shown in \Cref{fig:studyarea}. First, reliable measurement points ($\gamma_\textit{temp} \ge 0.65$) within a 200 m radius of each benchmark were selected. Average velocities were then derived for these points from both the InSAR and annual leveling survey time series, calculated as the slope of the best-fitting line to their respective displacement time series. Such a comparison based on rates was required due to the different temporal sampling intervals of the two datasets \Cref{fig:insar_leveling}.

\begin{figure}[H]
	\centering
	
	% --- Left Subplot (Figure A) ---
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
		\framebox{\rule{0pt}{8cm}\rule{\textwidth}{0pt}}
		\caption{} % <-- ADD THIS BACK. An empty caption just creates the "(a)".
		\label{fig:insar_leveling_a} % <-- ADD THIS BACK. Give it a unique label.
	\end{subfigure}
	\quad
	% --- Right Subplot (Figure B) ---
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
		\framebox{\rule{0pt}{8cm}\rule{\textwidth}{0pt}}
		\caption{} % <-- ADD THIS BACK. This will create the "(b)".
		\label{fig:insar_leveling_b} % <-- ADD THIS BACK. Give it another unique label.
	\end{subfigure}
	
	% --- Main Caption for the Entire Figure ---
	% You can now refer to (a) and (b) in your main caption if you wish.
	\caption{Comparison of InSAR results and leveling data. (a) The results from InSAR processing. (b) The ground truth data from leveling surveys.}
	\label{fig:insar_leveling} % This label is for the whole figure.
\end{figure}

%\subsection{Geographically Temporally Weighted Regression}
%\label{subsec:gtwr}

% ================================================================================
% ================================================================================

%\subsubsection{Model Calibration}
\subsection{Geographically Weighted Regression}
\label{subsec:gwr_method}

this research apply the geographically time-slice weighted regression to model the relationship between the differential displacement from MLCW and InSAR. because the traditional or global regression assumes that the relationship between the response and predictor variables are constant over space and time. this assumption is relaxed in GWR by allowing the parameters to vary spatially. 


%Before discussing the GTWR model, it is useful to review the fundamental concepts of ordinary least squares (OLS) regression and geographically weighted regression (GWR). The OLS models the relationship between a dependent variable and one or more predictors, under the assumption that the relationships being modeled are spatially stationary, expressed as:
%
%\begin{equation}
%	y_i = \sum_{k=0}^{p} \beta_k x_{ik} + \varepsilon_i
%	\label{eq:ols}
%\end{equation}
%
%\noindent where \(y_i\) denotes the dependent variable at the \(i\)-th location; \(x_{ik}\) represents the independent variables (or predictors), with \(x_{i0} = 1\) for the intercept \(\beta_0\); \(\beta_k\) indicates the regression coefficient corresponding to the \(k\)-th predictor; \(\varepsilon_i\) is the random error at the \(i\)-th location, and \(p\) is the number of independent variables (excluding the intercept).
%%
%The OLS method assigns a single set of coefficients to all observations regardless of their geographical locations, which deliberately neglects potential spatial variation and can cause model misspecification \citep{mgwr_book_2017}.
%%
%% ========================================
%% Section: Recap GWR concept
%% ========================================
%%
%The GWR approach allows the regression coefficients of the predictors to vary at different locations, thereby capturing local variations \citep{brunsdon1996, fotheringham2002geographically}. The GWR is formulated as follows:
%
%\begin{equation}
%y_i = \sum_{k=0}^{p} \beta_k(u_i, v_i) x_{ik} + \varepsilon_i
%\label{eq:gwr}
%\end{equation}